.env

AWS_REGION=us-east-1
CHIME_APP_INSTANCE_ARN=arn:aws:chime:us-east-1:YOUR_ACCOUNT_ID:app-instance/YOUR_INSTANCE_ID
CHIME_APP_ADMIN_ARN=arn:aws:chime:us-east-1:YOUR_ACCOUNT_ID:app-instance/YOUR_INSTANCE_ID/user/YOUR_USER_ID


Install SDK:

npm install @aws-sdk/client-chime-sdk-messaging

cd /opt/techacumen-chat/
npm install express cors dotenv

after all code pasted start server with this 
pkill node
nohup node server.js > server.log 2>&1 &


server.js

'use strict';

require('dotenv').config();
const express = require('express');
const cors = require('cors');
const { ChimeSDKMessagingClient, 
        ListChannelsCommand, 
        CreateChannelCommand,
        ListChannelMessagesCommand,
        SendChannelMessageCommand } = require('@aws-sdk/client-chime-sdk-messaging');

const app = express();
const PORT = process.env.PORT || 8000;
const REGION = process.env.AWS_REGION || 'us-east-1';

const chimeMsg = new ChimeSDKMessagingClient({ region: REGION });

app.use(cors());
app.use(express.json());
app.use(express.static(__dirname + '/public'));

// 1. List all threads (channels)
app.get('/api/threads', async (req, res) => {
  try {
    const resp = await chimeMsg.send(new ListChannelsCommand({
      AppInstanceArn: process.env.CHIME_APP_INSTANCE_ARN,
      ChimeBearer: process.env.CHIME_APP_ADMIN_ARN,
      MaxResults: 50
    }));
    // You can filter/sort channels as you like
    res.json((resp.Channels || []).map(channel => ({
      channelArn: channel.ChannelArn,
      name: channel.Name,
      created: channel.CreatedTimestamp
    })));
  } catch (err) {
    console.error("LIST THREADS ERR:", err);
    res.status(500).json({ error: err.message });
  }
});

// 2. Create new thread (channel)
app.post('/api/threads', async (req, res) => {
  const { name, user } = req.body;
  if (!name || !user) return res.status(400).json({ error: "Missing name or user" });
  try {
    const resp = await chimeMsg.send(new CreateChannelCommand({
      AppInstanceArn: process.env.CHIME_APP_INSTANCE_ARN,
      Name: name,
      Mode: 'UNRESTRICTED',
      Privacy: 'PUBLIC',
      ChimeBearer: process.env.CHIME_APP_ADMIN_ARN,
      Metadata: JSON.stringify({ user })
    }));
    res.json({ ok: true, channelArn: resp.ChannelArn });
  } catch (err) {
    console.error("CREATE THREAD ERR:", err);
    res.status(500).json({ error: err.message });
  }
});

// 3. List replies/messages in a thread (channel)
app.get('/api/thread/:channelArn', async (req, res) => {
  const channelArn = decodeURIComponent(req.params.channelArn);
  try {
    const resp = await chimeMsg.send(new ListChannelMessagesCommand({
      ChannelArn: channelArn,
      ChimeBearer: process.env.CHIME_APP_ADMIN_ARN,
      MaxResults: 50
    }));
    res.json({ messages: resp.ChannelMessages || [] });
  } catch (err) {
    console.error("LIST MSGS ERR:", err);
    res.status(500).json({ error: err.message });
  }
});

// 4. Post reply/message in thread (channel)
app.post('/api/reply', async (req, res) => {
  const { channelArn, content, user } = req.body;
  if (!channelArn || !content || !user) return res.status(400).json({ error: "Missing params" });
  try {
    const out = await chimeMsg.send(new SendChannelMessageCommand({
      ChannelArn: channelArn,
      ChimeBearer: process.env.CHIME_APP_ADMIN_ARN,
      Content: content,
      Persistence: 'PERSISTENT',
      Type: 'STANDARD',
      Metadata: JSON.stringify({ user }),
      ClientRequestToken: Math.random().toString(36).slice(2)
    }));
    res.json({ ok: true, messageId: out.MessageId });
  } catch (err) {
    console.error("SEND REPLY ERR:", err);
    res.status(500).json({ error: err.message });
  }
});

// Healthcheck and serve homepage
app.get('/health', (_req, res) => res.json({ ok: true }));
app.get('/', (req, res) => res.sendFile(__dirname + '/public/chatroom.html'));

app.listen(PORT, () => console.log(`Chime Chat server running on port ${PORT}`));


chatroom.html

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>TechnicalAcumen Chime Chatroom</title>
</head>
<body>
<div class="discord-chat-container">
  <aside class="discord-sidebar">
    <div class="discord-channel active"># general</div>
    <div class="sidebar-user" style="margin-top:auto;">
      <img src="https://api.dicebear.com/7.x/pixel-art/svg?seed=gomma" class="sidebar-avatar" alt="User" />
      <span class="sidebar-username">User</span>
    </div>
  </aside>
  <main class="discord-main">
    <div style="display:flex;align-items:center;gap:10px;padding:10px;">
      <input type="text" id="search" placeholder="Search threads..." style="flex:1;padding:0.5em;border-radius:6px;border:none;">
      <button id="post-btn" style="background:#8d43ff;color:#fff;border:none;padding:0.6em 1.5em;border-radius:6px;font-weight:bold;cursor:pointer;">Post</button>
    </div>
    <div id="threads" class="discord-messages" style="flex:1;min-height:0;"></div>
  </main>
</div>

<!-- Modal for New Thread -->
<div id="threadModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeThreadModal()">&times;</span>
    <h3 id="modalTitle">Start a new thread</h3>
    <input id="threadTitle" placeholder="Thread title..." style="width:100%;margin-bottom:10px;" />
    <button onclick="postThread()" class="post-btn">Post</button>
  </div>
</div>

<!-- Modal for Viewing a Thread/Replies -->
<div id="repliesModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeRepliesModal()">&times;</span>
    <h3 id="repliesTitle"></h3>
    <div id="repliesList" style="max-height:300px;overflow-y:auto;"></div>
    <textarea id="replyMsg" rows="2" style="width:100%;" placeholder="Reply to this thread..."></textarea>
    <br>
    <button onclick="postReply()" class="post-btn">Reply</button>
  </div>
</div>

<script>
const USER = "You";
const threadsDiv = document.getElementById('threads');
const postBtn = document.getElementById('post-btn');
const searchInput = document.getElementById('search');
let viewingThread = null;

// --- THREADS ---
function fetchThreads() {
  fetch('/api/threads')
    .then(res => res.json())
    .then(data => {
      threadsDiv.innerHTML = '';
      data.forEach(thread => {
        threadsDiv.innerHTML += `
          <div class="msg-bubble" style="margin-bottom:1.5em;cursor:pointer;" onclick="openRepliesModal('${encodeURIComponent(thread.channelArn)}', '${thread.name}')">
            <b>${thread.name}</b> <span style="color:#aaa;font-size:0.85em;">(${new Date(thread.created).toLocaleString()})</span>
          </div>
        `;
      });
      threadsDiv.scrollTop = threadsDiv.scrollHeight;
    });
}
setInterval(fetchThreads, 3000);
fetchThreads();

postBtn.onclick = function() {
  document.getElementById('modalTitle').textContent = "Start a new thread";
  document.getElementById('threadTitle').value = "";
  document.getElementById('threadModal').style.display = 'block';
};

function closeThreadModal() {
  document.getElementById('threadModal').style.display = 'none';
}
function postThread() {
  const title = document.getElementById('threadTitle').value.trim();
  if (!title) return alert("Please enter a thread title.");
  closeThreadModal();
  fetch('/api/threads', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name: title, user: USER })
  }).then(() => {
    document.getElementById('threadTitle').value = '';
    fetchThreads();
  });
}

// --- REPLIES MODAL ---
function openRepliesModal(channelArn, threadTitle) {
  viewingThread = channelArn;
  document.getElementById('repliesModal').style.display = 'block';
  document.getElementById('repliesTitle').innerHTML = `<b>${threadTitle}</b>`;
  document.getElementById('replyMsg').value = '';
  // Fetch replies/messages
  fetch(`/api/thread/${channelArn}`)
    .then(res => res.json())
    .then(data => {
      const repliesList = document.getElementById('repliesList');
      repliesList.innerHTML = '';
      (data.messages || []).forEach(msg => {
        repliesList.innerHTML += `<div class="msg-bubble" style="margin:0.5em 0;"><b>${(msg.Metadata && JSON.parse(msg.Metadata).user) || 'User'}:</b> ${msg.Content}</div>`;
      });
    });
}
function closeRepliesModal() {
  document.getElementById('repliesModal').style.display = 'none';
  viewingThread = null;
}
function postReply() {
  const msg = document.getElementById('replyMsg').value.trim();
  if (!msg || !viewingThread) return alert("Type a reply!");
  fetch('/api/reply', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      channelArn: viewingThread,
      content: msg,
      user: USER
    })
  }).then(() => {
    document.getElementById('replyMsg').value = '';
    openRepliesModal(viewingThread, document.getElementById('repliesTitle').textContent);
    fetchThreads();
  });
}

// ESC to close modals
window.onkeydown = function(e) {
  if (e.key === "Escape") {
    closeThreadModal();
    closeRepliesModal();
  }
};
</script>
</body>
</html>


style.css

.modal {
  display: none; position: fixed; z-index: 9999;
  left: 0; top: 0; width: 100vw; height: 100vh;
  background: rgba(0,0,0,0.4);
  justify-content: center; align-items: center;
}
.modal .modal-content {
  background: #23272a;
  padding: 2em;
  border-radius: 12px;
  max-width: 450px; width: 95vw;
  margin: 4em auto;
  color: #fff;
  position: relative;
}
.modal .close {
  position: absolute; top: 10px; right: 18px; cursor: pointer;
  font-size: 2em; color: #aaa;
}

-------------------------------------------------------------------------------------------------------------------------------------------
Old
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=0.1" />

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/all.min.css"/>

  <title>AI RESOURCE HUB</title>


  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;500&family=DM+Serif+Text&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Philosopher&display=swap" rel="stylesheet">

</head>

<body>
<!-- Discord-Style Chatroom START -->
<div class="discord-chat-container">
  <aside class="discord-sidebar">
    <div class="discord-channel active"># general</div>
    <!-- You can add more channels here -->
<div class="sidebar-user">
  <img src="https://api.dicebear.com/7.x/pixel-art/svg?seed=gomma" class="sidebar-avatar" alt="User" />
  <span class="sidebar-username">User</span>
</div>
  </aside>
  <main class="discord-main">
<div style="display: flex; align-items: center; gap: 10px; padding: 10px;">
  <button id="post-btn" style="background: #8d43ff; color: #fff; border: none; padding: 0.6em 1.5em; border-radius: 6px; font-weight: bold; cursor: pointer;">Post</button>
</div>

<div class="chat-buttons">
  <button>My Posts</button>
  <button>Suggestions</button>
  <button>Favourites</button>
</div>
    <div id="messages" class="discord-messages"></div>
<div style="padding: 10px; background: #40444b;">
  <input type="text" id="msg" placeholder="Type your thread post..." autocomplete="off" style="width: 90%; padding: 0.6em; border-radius: 6px; border: none; background: #2f3136>
</div>

  </main>

<div id="threadModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeThreadModal()">&times;</span>
    <h3>Start a new thread</h3>
    <textarea id="threadMsg" rows="4" style="width: 100%;" placeholder="What do you want to discuss?"></textarea>
    <br>
    <button onclick="postThread()" class="post-btn">Post Thread</button>
  </div>
</div>

</div>

<script>
const USER = "You";
const threadsDiv = document.getElementById('threads');
const postBtn = document.getElementById('post-btn');
const msgInput = document.getElementById('msg');

function fetchThreads() {
  fetch('/api/threads')
    .then(res => res.json())
    .then(data => {
      threadsDiv.innerHTML = '';
      data.forEach(thread => {
        threadsDiv.innerHTML += `
          <div class="msg-bubble" style="margin-bottom: 2em;">
            <b>${thread.user}:</b> ${thread.text}
          </div>
        `;
      });
      threadsDiv.scrollTop = threadsDiv.scrollHeight;
    });
}

setInterval(fetchThreads, 2000);
fetchThreads();

postBtn.onclick = function() {
  if (!msgInput.value.trim()) return;
  fetch('/api/threads', {

    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ text: msgInput.value, user: USER })
  }).then(() => {
    msgInput.value = '';
    fetchThreads();
  });
};

chatForm.onsubmit = function(e) {
  e.preventDefault();
  if (!msgInput.value.trim()) return;
fetch('/api/chime/send', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    channelArn: "arn:aws:chime:us-east-1:161289594039:app-instance/7d160e34-c880-436f-b006-435a9387c439/channel/f20095c6-041f-488a-bfa6-5bd56e4dbdd1",
    senderArn: "arn:aws:chime:us-east-1:161289594039:app-instance/7d160e34-c880-436f-b006-435a9387c439/user/ta-admin",
    content: msgInput.value
  })
}).then(() => {
    msgInput.value = '';
    fetchMessages();
  });
};

function openThreadModal() {
  document.getElementById('threadModal').style.display = 'block';
}
function closeThreadModal() {
  document.getElementById('threadModal').style.display = 'none';
}
function postThread() {
  const msg = document.getElementById('threadMsg').value.trim();
  if (!msg) return alert("Please type something for your thread.");
  closeThreadModal();
  alert("Thread posted (demo)!"); // Replace with real logic
  document.getElementById('threadMsg').value = '';
}

</script>

</body>
</html>

